{% extends "owner/base.html" %}

{% block title %}Báo cáo Thống kê{% endblock %}

{% block content %}

<div class="owner-header">
    <div>
        <h1 class="owner-header-title">
            <i class="fas fa-chart-bar me-2"></i> Báo cáo Thống kê
        </h1>
        <p class="owner-header-subtitle">Tổng hợp các chỉ số kinh doanh quan trọng</p>
    </div>
    <div class="owner-header-actions">
        <form method="POST" action="{{ url_for('owner.export_report') }}" style="display: inline;">
            <button type="submit" class="owner-btn owner-btn-success">
                <i class="fas fa-file-export"></i> Xuất báo cáo
            </button>
        </form>
    </div>
</div>

{% set payload = result[0].json if result and result[1] == 200 else None %}
{% set data = payload.data if payload and payload.data else None %}

{% if data %}
    <!-- Statistics Cards -->
    <div class="owner-stats-row mb-4">
        <div class="owner-stat-card">
            <div class="owner-stat-content">
                <h6>Tổng khách sạn</h6>
                <div class="stat-value">{{ data.total_hotels if data.total_hotels else 0 }}</div>
                <div class="stat-label">Khách sạn đang hoạt động</div>
            </div>
            <div class="owner-stat-icon">
                <i class="fas fa-hotel"></i>
            </div>
        </div>

        <div class="owner-stat-card success">
            <div class="owner-stat-content">
                <h6>Tổng booking</h6>
                <div class="stat-value">{{ data.total_bookings if data.total_bookings else 0 }}</div>
                <div class="stat-label">Tất cả đơn đặt</div>
            </div>
            <div class="owner-stat-icon">
                <i class="fas fa-calendar-check"></i>
            </div>
        </div>

        <div class="owner-stat-card info">
            <div class="owner-stat-content">
                <h6>Doanh thu</h6>
                <div class="stat-value">{{ "{:,.0f}".format(data.total_revenue) if data.total_revenue else 0 }}</div>
                <div class="stat-label">VNĐ</div>
            </div>
            <div class="owner-stat-icon">
                <i class="fas fa-money-bill-wave"></i>
            </div>
        </div>

        <div class="owner-stat-card warning">
            <div class="owner-stat-content">
                <h6>Đánh giá</h6>
                <div class="stat-value">{{ "{:.1f}".format(data.avg_rating) if data.avg_rating else 0 }}</div>
                <div class="stat-label">Trung bình / 5 sao</div>
            </div>
            <div class="owner-stat-icon">
                <i class="fas fa-star"></i>
            </div>
        </div>
    </div>

    <!-- Additional Statistics Content -->
    <div class="owner-card">
        <div class="p-4">
            <h5 class="mb-3"><i class="fas fa-info-circle me-2"></i> Thông tin chi tiết</h5>
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Tổng phòng:</strong> {{ data.total_rooms if data.total_rooms else 0 }}</p>
                    <p><strong>Tổng người dùng:</strong> {{ data.total_users if data.total_users else 0 }}</p>
                </div>
                <div class="col-md-6">
                    <p><strong>Booking đang chờ:</strong> {{ data.pending_bookings if data.pending_bookings else 0 }}</p>
                    <p><strong>Booking đã hoàn thành:</strong> {{ data.completed_bookings if data.completed_bookings else 0 }}</p>
                </div>
            </div>
        </div>
    </div>
{% else %}
    <div class="owner-empty-state">
        <div class="owner-empty-icon">
            <i class="fas fa-chart-bar"></i>
        </div>
        <h4 class="owner-empty-title">Không có dữ liệu thống kê</h4>
        <p class="owner-empty-text">Chưa có dữ liệu để hiển thị báo cáo.</p>
    </div>
{% endif %}

{% endblock %}
