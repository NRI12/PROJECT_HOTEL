<!DOCTYPE html>
<html>
<head>
    <title>Chi tiết mã giảm giá</title>
</head>
<body>
    <h1>Chi tiết mã giảm giá</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <p class="flash-{{ category }}">{{ message }}</p>
            {% endfor %}
        {% endif %}
    {% endwith %}

    {% set payload = result[0].json if result and result[1] == 200 else None %}
    {% set discount = payload.data.discount if payload and payload.data and payload.data.discount else None %}

    {% if discount %}
        <h2>{{ discount.code }}</h2>
        <p>Mô tả: {{ discount.description or 'Không có' }}</p>
        <p>Loại giảm: {{ 'Phần trăm' if discount.discount_type == 'percentage' else 'Cố định' }}</p>
        <p>Giá trị giảm: {{ discount.discount_value }}</p>
        <p>Đơn tối thiểu: {{ discount.min_order_amount }}</p>
        <p>Giảm tối đa: {{ discount.max_discount_amount or 'Không giới hạn' }}</p>
        <p>Giới hạn lượt dùng: {{ discount.usage_limit or 'Không giới hạn' }}</p>
        <p>Số lượt đã dùng: {{ discount.used_count }}</p>
        <p>Hiệu lực từ: {{ discount.start_date }}</p>
        <p>Đến: {{ discount.end_date }}</p>
        <p>Trạng thái: {{ 'Đang hoạt động' if discount.is_active else 'Đã tắt' }}</p>

        <p>
            <a href="{{ url_for('discount.edit_discount', code_id=discount.code_id) }}">Chỉnh sửa</a>
        </p>
        <form method="POST" action="{{ url_for('discount.delete_discount', code_id=discount.code_id) }}">
            <button type="submit" onclick="return confirm('Bạn chắc chắn muốn xóa?')">Xóa mã</button>
        </form>
    {% else %}
        <p>Không tìm thấy mã giảm giá.</p>
    {% endif %}

    <p><a href="{{ url_for('discount.list_discounts') }}">Quay lại danh sách</a></p>
</body>
</html>

