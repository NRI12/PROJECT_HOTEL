<!DOCTYPE html>
<html>
<head>
    <title>Cập nhật mã giảm giá</title>
</head>
<body>
    <h1>Cập nhật mã giảm giá #{{ code_id }}</h1>
    <p>Chỉ nhập các trường cần thay đổi, các trường để trống sẽ được giữ nguyên.</p>

    {% if error %}
        <p style="color:red;">{{ error }}</p>
    {% endif %}

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <p class="flash-{{ category }}">{{ message }}</p>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <form method="POST" action="{{ url_for('discount.edit_discount', code_id=code_id) }}">
        <div>
            <label>Mã</label>
            <input type="text" name="code" value="{{ request.form.get('code', '') }}">
        </div>
        <div>
            <label>Mô tả</label>
            <textarea name="description">{{ request.form.get('description', '') }}</textarea>
        </div>
        <div>
            <label>Loại giảm</label>
            <select name="discount_type">
                <option value="">-- Không thay đổi --</option>
                <option value="percentage" {% if request.form.get('discount_type') == 'percentage' %}selected{% endif %}>Phần trăm</option>
                <option value="fixed" {% if request.form.get('discount_type') == 'fixed' %}selected{% endif %}>Cố định</option>
            </select>
        </div>
        <div>
            <label>Giá trị giảm</label>
            <input type="number" step="0.01" min="0" name="discount_value" value="{{ request.form.get('discount_value', '') }}">
        </div>
        <div>
            <label>Đơn tối thiểu</label>
            <input type="number" step="0.01" min="0" name="min_order_amount" value="{{ request.form.get('min_order_amount', '') }}">
        </div>
        <div>
            <label>Giảm tối đa</label>
            <input type="number" step="0.01" min="0" name="max_discount_amount" value="{{ request.form.get('max_discount_amount', '') }}">
        </div>
        <div>
            <label>Giới hạn lượt dùng</label>
            <input type="number" min="1" name="usage_limit" value="{{ request.form.get('usage_limit', '') }}">
        </div>
        <div>
            <label>Ngày bắt đầu</label>
            <input type="datetime-local" name="start_date" value="{{ request.form.get('start_date', '') }}">
        </div>
        <div>
            <label>Ngày kết thúc</label>
            <input type="datetime-local" name="end_date" value="{{ request.form.get('end_date', '') }}">
        </div>
        <div>
            <label>Trạng thái</label>
            <select name="is_active">
                <option value="">-- Không thay đổi --</option>
                <option value="true" {% if request.form.get('is_active') == 'true' %}selected{% endif %}>Kích hoạt</option>
                <option value="false" {% if request.form.get('is_active') == 'false' %}selected{% endif %}>Tắt</option>
            </select>
        </div>
        <div>
            <button type="submit">Lưu</button>
            <a href="{{ url_for('discount.list_discounts') }}">Hủy</a>
        </div>
    </form>
</body>
</html>

