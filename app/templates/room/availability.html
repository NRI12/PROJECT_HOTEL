<!DOCTYPE html>
<html>
<head>
    <title>Kiểm tra phòng trống</title>
</head>
<body>
    <h1>Kiểm tra phòng trống</h1>
    
    {% if result and result[0].get_json() %}
        {% if result[0].get_json().success %}
            {% set data = result[0].get_json().data %}
            
            <h2>Kết quả kiểm tra</h2>
            <table border="1">
                <tr>
                    <th>Thông tin</th>
                    <th>Giá trị</th>
                </tr>
                <tr>
                    <td>ID Phòng</td>
                    <td>{{ data.room_id }}</td>
                </tr>
                <tr>
                    <td>Ngày nhận phòng</td>
                    <td>{{ data.check_in }}</td>
                </tr>
                <tr>
                    <td>Ngày trả phòng</td>
                    <td>{{ data.check_out }}</td>
                </tr>
                <tr>
                    <td>Tổng số phòng</td>
                    <td>{{ data.total_quantity }}</td>
                </tr>
                <tr>
                    <td>Số phòng còn trống</td>
                    <td>{{ data.available_quantity }}</td>
                </tr>
                <tr>
                    <td>Trạng thái phòng</td>
                    <td>{{ data.status }}</td>
                </tr>
                <tr>
                    <td><strong>Có thể đặt?</strong></td>
                    <td>
                        {% if data.is_available %}
                            <strong style="color: green;">CÓ</strong>
                        {% else %}
                            <strong style="color: red;">KHÔNG</strong>
                        {% endif %}
                    </td>
                </tr>
            </table>
            
            {% if data.is_available %}
                <p><a href="/booking/create?room_id={{ data.room_id }}&check_in={{ data.check_in }}&check_out={{ data.check_out }}">Đặt phòng ngay</a></p>
            {% else %}
                <p style="color: red;">Phòng không có sẵn trong khoảng thời gian này</p>
            {% endif %}
            
        {% else %}
            <div style="color: red; border: 1px solid red; padding: 10px; margin: 10px 0;">
                <strong>Lỗi:</strong> {{ result[0].get_json().message }}
            </div>
        {% endif %}
    {% endif %}
    
    <h2>Kiểm tra lại với ngày khác</h2>
    <form method="GET" action="/room/{{ room_id }}/availability">
        <div>
            <label>Ngày nhận phòng:</label>
            <input type="date" name="check_in" value="{{ request.args.check_in or '' }}" required>
        </div>
        
        <div>
            <label>Ngày trả phòng:</label>
            <input type="date" name="check_out" value="{{ request.args.check_out or '' }}" required>
        </div>
        
        <div>
            <button type="submit">Kiểm tra</button>
        </div>
    </form>
    
    <p><a href="/room/{{ room_id }}">Quay lại chi tiết phòng</a></p>
    <p><a href="/room">Quay lại danh sách</a></p>
</body>
</html>